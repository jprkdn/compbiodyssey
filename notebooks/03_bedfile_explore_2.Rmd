---
title: "BED File Analysis Pt. 2"
output: html_document
---

# Week 1: Practice with BED files part 2

This notebook is designed to test additional manipulations of BED files with 15 additional prompts generated by ChatGPT for me to review and play with. Following my practice with tidyverse vs. base R, I am looking at new prompts with a new BED file.

---

## Load libraries
```{r, setup, message=FALSE, warning=FALSE}
library(tidyverse)
```
##when I run this chunk, it loads tidyverse
---

##Load the BED file
```{r}
bed_file = read_tsv("/Users/Jay/Documents/My Projects/compbio-projects/compbiodyssey/data/interview_bed_file.bed",col_names = FALSE) %>%
  setNames(c("chrom","start","end","name","score","strand"))
head(bed_file)
```

---

###How many rows are there in the bed file?
```{r}
dim(bed_file)[1]

```
---

##Tidyverse answer
```{r}
bed_file %>% summarize(n()) %>% pull()

```

---

###How many unique chromosomes are present?
```{r}
length(unique(bed_file$chrom))

```

## Tidyverse answer
```{r}
bed_file %>% select(chrom) %>%
  distinct() %>%
  summarize(n())
```

---
##Which chromosome has the most entries
```{r}
sort(table(bed_file$chrom),decreasing = TRUE)[1]

```

---

## Now in tidyverse
```{r}
bed_file %>% count(chrom) %>%
  arrange(desc(n)) %>%
  slice(1) %>%
  pull(chrom)
 
```

---

## What is the average region length?
```{r}
mean(bed_file$end - bed_file$start)

```

---

## Now in tidyverse
```{r}
bed_file %>% mutate(length = end - start) %>%
  summarize(mean(length)) %>%
  pull()

```
## Filter for regions on the '+' strand and on chr1
```{r}
unlist(bed_file[which(bed_file$strand=="+" & bed_file$chrom=="chr1"),"name"])

```

---

## Now in tidyverse

```{r}
bed_file %>% filter(strand=="+" & chrom == "chr1") %>%
  pull(name)
```

---

##Find the top 5 highest scoring regions. Do it in tidyverse because I actually forgot how to do it in base R.

```{r}
bed_file %>% slice_max(score,n = 5) %>%
  pull(name)
  

bed_file %>% arrange(desc(score)) %>%
  head(5) %>%
  pull(name)
```


---

##Count how many regions fall in each strand. I also am going straight to tidyverse and here's three ways of doing it. The first is by subsetting + and - and then just summarizing. The second is counting but assumes there's one region per row. The 2nd is universal.

```{r}
bed_file %>% filter(strand=="+") %>%
  count(name) %>%
  summarize(n()) %>%
  pull()

bed_file %>% filter(strand=="-") %>%
  count(name) %>%
  summarize(n()) %>%
  pull()

bed_file %>% count(strand)

bed_file %>% group_by(strand) %>%
  summarize(n_distinct(name))
```

---

## Add a column for region length

```{r}
bed_file = bed_file %>% mutate(length = end-start)

```

---





